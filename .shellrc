# Configure PATH
export PATH=$HOME/.local/bin:$PATH

ipaddr() {
    # https://stackoverflow.com/questions/8529181/which-terminal-command-to-get-just-ip-address-and-nothing-else
    # `| cut -f1` is to remove red color from grep
    ip -4 addr show eth0 | grep -oP '(?<=inet\s)\d+(\.\d+){3}' | cut -f1
}

firefox_wsl() {
    # todo: support multiple files.
    # this will requires some sed-magic due to backslash treatment
    # https://unix.stackexchange.com/questions/70459/treatment-of-backslashes-across-shells
    DOCUMENT_PATH="$1"
    if [ -f "$1" ]
    then
        DOCUMENT_PATH=$(wslpath -w $1)
    fi
    FIREFOX_PATH="/mnt/c/Program Files/Mozilla Firefox/firefox.exe"
    if [ -f "$FIREFOX_PATH" ]
    then
        "$FIREFOX_PATH" "$DOCUMENT_PATH"
    else
        echo "Couldn't find firefox executable at $FIREFOX_PATH"
    fi
}

paintdotnet_wsl() {
    # todo: support multiple files.
    # this will requires some sed-magic due to backslash treatment
    # https://unix.stackexchange.com/questions/70459/treatment-of-backslashes-across-shells
    DOCUMENT_PATH="$1"
    if [ -f "$1" ]
    then
        DOCUMENT_PATH=$(wslpath -w $1)
    fi
    PAINTDOTNET_PATH=$(wslpath "C:\Program Files\paint.net\paintdotnet.exe")
    if [ -f "$PAINTDOTNET_PATH" ]
    then
        "$PAINTDOTNET_PATH" "$DOCUMENT_PATH"
    else
        echo "Couldn't find paint.net executable at $PAINTDOTNET_PATH"
    fi
}

# Map WSL compatible firefox command if firefox is not installed
if ! which firefox > /dev/null 2>&1
then
    alias firefox=firefox_wsl
fi

# Map WSL compatible paintdotnet command if paintdotnet is not installed
if ! which paintdotnet > /dev/null 2>&1
then
    alias paintdotnet=paintdotnet_wsl
fi

# Map WSL compatible paintdotnet command if eog is not installed
if ! which eog > /dev/null 2>&1
then
    alias eog=paintdotnet_wsl
fi

# Map WSL compatible firefox command if firefox is not installed
if ! which firefox > /dev/null 2>&1
then
    alias firefox=firefox_wsl
fi

# Alias c= to "code ." if vscode is installed
if which code > /dev/null 2>&1
then
    alias c="code ."
fi

# Source local shellrc last so that it takes priority
if [ -f $HOME/.local.shellrc ]
then
    source $HOME/.local.shellrc
fi

if [ $WSL_DISTRO_NAME != "" ]
then
    $HOME/.dotfiles/onedrive_linux.sh -d > /dev/null 2>&1
fi
