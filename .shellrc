# Configure PATH
export PATH=$HOME/.local/bin:$PATH

ipaddr() {
    # https://stackoverflow.com/questions/8529181/which-terminal-command-to-get-just-ip-address-and-nothing-else
    # `| cut -f1` is to remove red color from grep
    ip -4 addr show eth0 | grep -oP '(?<=inet\s)\d+(\.\d+){3}' | cut -f1
}

exe_with_file_argument_wsl() {
    # todo: support multiple files.
    # this will requires some sed-magic due to backslash treatment
    # https://unix.stackexchange.com/questions/70459/treatment-of-backslashes-across-shells
    EXE_PATH=$1
    shift 1
    DOCUMENT_PATH=$1

    if [ ! -f "$EXE_PATH" ]
    then
        EXE_PATH=$(wslpath "$EXE_PATH")
        if [ ! -f "$EXE_PATH" ]
        then
            echo "Couldn't find executable $EXE_PATH" >&2
            exit 1
        fi
    fi
    if [ -f "$DOCUMENT_PATH" ]
    then
        DOCUMENT_PATH=$(wslpath -w "$DOCUMENT_PATH")
    fi

    "$EXE_PATH" "$DOCUMENT_PATH"
}

# Map WSL compatible firefox command if firefox is not installed
if ! which firefox > /dev/null 2>&1
then
    alias firefox='exe_with_file_argument_wsl "/mnt/c/Program Files/Mozilla Firefox/firefox.exe"'
fi

# Map WSL compatible paintdotnet command if paintdotnet is not installed
if ! which paintdotnet > /dev/null 2>&1
then
    alias paintdotnet='exe_with_file_argument_wsl "C:\Program Files\paint.net\paintdotnet.exe"'
fi

# Map WSL compatible paintdotnet command if eog is not installed
if ! which eog > /dev/null 2>&1
then
    alias eog='paintdotnet'
fi

# Map WSL compatible word command if word is not installed
if ! which word > /dev/null 2>&1
then
    alias word='exe_with_file_argument_wsl "C:\Program Files\Microsoft Office\root\Office16\WINWORD.EXE"'
fi

# Map WSL compatible powerpoint command if powerpoint is not installed
if ! which powerpoint > /dev/null 2>&1
then
    alias powerpoint='exe_with_file_argument_wsl "C:\Program Files\Microsoft Office\root\Office16\POWERPNT.EXE"'
fi

# Map WSL compatible excel command if excel is not installed
if ! which excel > /dev/null 2>&1
then
    alias excel='exe_with_file_argument_wsl "C:\Program Files\Microsoft Office\root\Office16\EXCEL.EXE"'
fi

# Map WSL compatible adobe command if adobe is not installed
if ! which adobe > /dev/null 2>&1
then
    alias adobe='exe_with_file_argument_wsl "C:\Program Files\Adobe\Acrobat DC\Acrobat\Acrobat.exe"'
fi

# Map WSL compatible gimp command if gimp is not installed
if ! which gimp > /dev/null 2>&1
then
    alias gimp='exe_with_file_argument_wsl "C:\Program Files\GIMP 2\bin\gimp-2.10.exe"'
fi

# Map WSL compatible notepad command if notepad is not installed
if ! which notepad > /dev/null 2>&1
then
    alias notepad='exe_with_file_argument_wsl "/mnt/c/Windows/notepad.exe"'
fi

# Alias c to "code ." if vscode is installed
if which code > /dev/null 2>&1
then
    alias c="code ."
fi

# Source local shellrc last so that it takes priority
if [ -f $HOME/.local.shellrc ]
then
    source $HOME/.local.shellrc
fi
